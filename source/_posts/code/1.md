---
title: 1
date: 2022-8-12 14:31:02
cover: 
tags:
- code
---
# 按天批量写入
```java
            Date d1= DateUtils.parseDate(dateBegin,"yyyyMMdd");
            Date d2= DateUtils.parseDate(dateEnd,"yyyyMMdd");
            if(d1.after(d2) ){
                return new BaseResult(BaseMessage.FAILED.getCode(),"开始时间不可大于结束时间","");
            }
            while(d2.after(d1)||d1.equals(d2)){
                liquidateFundFlowService.refreshFundFLowBizInfo(d1);
                d1=DateUtils.addDays(d1,1);
            }
```
```java
        tranDate = DateUtils.truncate(tranDate, Calendar.DATE);
        Date tranDateEnd = DateUtils.addDays(tranDate,1);
        Long maxId = null;
        while (true){
            PageHelper.offsetPage(0, 1000, false);
            LiquidateBizFlowExample example = new LiquidateBizFlowExample();
            LiquidateBizFlowExample.Criteria criteria = example.createCriteria()
                    .andDeleteFlagEqualTo(DeleteFlag.ENABLE.getIndex())
                    .andSysCtimeGreaterThan(tranDate)
                    .andSysCtimeLessThan(tranDateEnd)
                    .andOperateTypeEqualTo(LiquidateOperateType.FUND.getCode());
            example.setOrderByClause("id");
            if (null != maxId){
                criteria.andIdGreaterThan(maxId);
            }
            List<LiquidateBizFlow> liquidateBizFlows = liquidateBizFlowMapper.selectByExample(example);
            if (CollectionUtils.isEmpty(liquidateBizFlows)){
                break;
            }
            maxId = liquidateBizFlows.get(liquidateBizFlows.size() - 1).getId();
```
